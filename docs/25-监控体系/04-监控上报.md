---
title: 监控上报
---

## 上报方式

![](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/af82cfafe40b4beabee071b54395a4f7~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp)

- Navigator.sendBeacon()

- GIF
首先，1x1像素是最小的合法图片。而且，因为是通过图片打点，所以图片最好是透明的，这样一来不会影响页面本身展示效果，二者表示图片透明只要使用一个二进制位标记图片是透明色即可，不用存储色彩空间数据，可以节约体积。因为需要透明色，所以可以直接排除JEPG。
​
同样的响应，GIF可以比BMP节约41%的流量，比PNG节约35%的流量。GIF才是最佳选择。

- 可以进行跨域
- 不会携带cookie
- 不需要等待服务器返回数据

## 上报策略

采集性能指标后，最好先对异常数据处理（抹平异步数据）

- 设置抽样策略

- 强网情况下直接上报，弱网存储在本地，网络情况好的时候再上报

- 可以采用延迟上报和批量上报



## 参考

- [MDN-Navigator.sendBeacon](https://developer.mozilla.org/zh-CN/docs/Web/API/Navigator/sendBeacon)
- [为什么大厂前端监控都在用GIF做埋点？](https://juejin.cn/post/7065123244881215518)
- [前端异常监控解决方案研究](https://mp.weixin.qq.com/s/0P4WrZtvIz_S59zalHE9UQ)

